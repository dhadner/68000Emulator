       ORG      $00010000
start:
       MOVEA.L #$1800,SP
       MOVEQ   #0,D0
       MOVE.L  D0,$00001800
       MOVE.L  D0,$00001804
       MOVE.L  D0,$00001808
       MOVEQ   #1,D0
       MOVE.L  D0,$0000180c
       MOVE.B  #$0080,D0
       MOVE.B  D0,$00001810
       MOVE.B  #$0040,D0
       MOVE.B  D0,$00001811
       MOVE.B  #$0020,D0
       MOVE.B  D0,$00001812
       MOVE.B  #$0010,D0
       MOVE.B  D0,$00001813
       MOVE.B  #$0008,D0
       MOVE.B  D0,$00001814
       MOVE.B  #$0004,D0
       MOVE.B  D0,$00001815
       MOVE.B  #$0002,D0
       MOVE.B  D0,$00001816
       MOVE.B  #$0001,D0
       MOVE.B  D0,$00001817
       LINK    A5,#0
       MOVE.L  $00001800,D0
       ADDQ.L  #1,D0
       MOVE.L  D0,$00001800
       CMP.L   #$000186a0,D0
       BLE     $0001008c
       MOVEQ   #0,D0
       MOVE.L  D0,$00001800
       MOVE.L  $0000180c,D2
       BEQ     $00010084
       MOVE.L  #$00000000,$0000180c
       BRA     $0001008c
       MOVE.L  #$00000001,$0000180c
       MOVE.L  $00001804,D0
       ADDQ.L  #1,D0
       MOVE.L  D0,$00001804
       MOVE.L  $00001808,D0
       ADDQ.L  #1,D0
       MOVE.L  D0,$00001808
       MOVE.L  $00001804,D0
       TST.L   D0
       BLE     $000100b4
       MOVE.L  $00001804,D0
       CMP.L   #$00000200,D0
       BLE     $000100ba
       MOVEQ   #1,D0
       MOVE.L  D0,$00001804
       MOVE.L  $00001808,D0
       TST.L   D0
       BLE     $000100ce
       MOVE.L  $00001808,D0
       CMP.L   #$00000156,D0
       BLE     $000100d4
       MOVEQ   #1,D0
       MOVE.L  D0,$00001808
       MOVE.L  $00001804,D0
       MOVE.L  $00001808,D1
       MOVE.L  $0000180c,D2
       BSR     $000100e6
       BRA     $0001005c
       MOVE.L  D4,-(SP)
       SUBQ.L  #1,D0
       SUBQ.L  #1,D1
       LSL.L   #6,D1
       MOVE.L  D0,D4
       LSR.L   #3,D4
       ADD.L   D4,D1
       AND.L   #$00000007,D0
       LEA     $00001810,A0
       MOVE.B  (0,A0,D0.W),D4
       LEA     $003fa700,A0
       TST.B   D2
       BEQ     $00010112
       OR.B    D4,(0,A0,D1.W)
       BRA     $00010118
       NOT.L   D4
       AND.B   D4,(0,A0,D1.W)
       MOVE.L  (SP)+,D4
       RTS
       MOVEM.L D0-A7,-(SP)
       MOVEA.L #$003fa700,A0
       EOR.L   D1,D1
       MOVE.L  #$00005580,D0
       MOVE.B  D1,(A0)+
       SUBQ.W  #1,D0
       BNE     $0001012e
       MOVEM.L (SP)+,D0-A7
       RTS
       LINK    A5,#0
       MOVE.L  $00001800,D0
       ADDQ.L  #1,D0
       MOVE.L  D0,$00001800
       CMP.L   #$0007a120,D0
       BLE     $00010156
       MOVEQ   #0,D0
       MOVE.L  D0,$00001800
       MOVE.L  $00001804,D0
       ADDQ.L  #1,D0
       MOVE.L  D0,$00001804
       MOVE.L  $00001808,D0
       ADDQ.L  #1,D0
       MOVE.L  D0,$00001808
       MOVE.L  $00001804,D0
       TST.L   D0
       BLE     $0001017e
       MOVE.L  $00001804,D0
       CMP.L   #$00000200,D0
       BLE     $00010184
       MOVEQ   #1,D0
       MOVE.L  D0,$00001804
       MOVE.L  $00001808,D0
       TST.L   D0
       BLE     $00010198
       MOVE.L  $00001808,D0
       CMP.L   #$00000156,D0
       BLE     $0001019e
       MOVEQ   #1,D0
       MOVE.L  D0,$00001808
       MOVE.L  $0000180c,D2
       MOVE.L  $00001808,D1
       MOVE.L  $00001804,D0
       MOVE.L  D2,-(SP)
       MOVE.L  D1,-(SP)
       MOVE.L  D0,-(SP)
       BSR     $000101b8
       LEA     ($000c,SP),SP
       BRA     $0001013e
       LINK    A5,#0
       MOVE.L  D3,-(SP)
       MOVE.L  D2,-(SP)
       MOVE.L  ($0008,A5),D0
       MOVE.L  ($000c,A5),D1
       MOVEA.L ($0010,A5),A0
       TST.L   D0
       BLE     $000101d8
       CMP.L   #$00000200,D0
       BLE     $000101dc
       BRA     $0001025e
       TST.L   D1
       BLE     $000101e8
       CMP.L   #$00000156,D1
       BLE     $000101ea
       BRA     $0001025e
       CMPA    #$0000,A0
       BEQ     $000101f8
       MOVEQ   #1,D2
       CMP.L   A0,D2
       BEQ     $000101f8
       BRA     $0001025e
       SUBQ.L  #1,D0
       SUBQ.L  #1,D1
       LSL.L   #6,D1
       MOVEA.L D1,A1
       MOVE.L  D0,D1
       LSR.L   #3,D1
       MOVE.L  A1,D2
       ADD.L   D1,D2
       MOVEQ   #7,D1
       AND.L   D0,D1
       MOVE.L  #$00001810,D0
       MOVEA.L D1,A1
       MOVE.B  (0,A1,D0.L),D3
       CMPA    #$0000,A0
       BEQ     $0001023c
       MOVE.L  #$003fa700,D0
       MOVEA.L D2,A0
       MOVE.B  (0,A0,D0.L),D0
       MOVE.B  D0,D1
       OR.B    D3,D1
       MOVE.L  #$003fa700,D0
       MOVEA.L D2,A1
       MOVE.B  D1,(0,A1,D0.L)
       BRA     $0001025e
       MOVE.L  #$003fa700,D0
       MOVEA.L D2,A0
       MOVE.B  (0,A0,D0.L),D0
       MOVE.B  D0,D1
       MOVE.B  D3,D0
       NOT.B   D0
       AND.B   D1,D0
       MOVE.B  D0,D1
       MOVE.L  #$003fa700,D0
       MOVEA.L D2,A1
       MOVE.B  D1,(0,A1,D0.L)
       MOVE.L  (SP)+,D2
       MOVE.L  (SP)+,D3
       UNLK    A5
       RTS
       END      start
